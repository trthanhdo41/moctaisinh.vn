<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Mộc Tái Sinh">

  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="Khám phá bộ sưu tập sản phẩm gỗ tái sinh độc đáo. Đồ gỗ thủ công handmade từ gỗ cũ, tre tái chế. Sản phẩm gỗ mộc chất lượng, thân thiện môi trường.">
  <meta name="keywords" content="sản phẩm gỗ tái sinh, đồ gỗ thủ công, gỗ handmade, gỗ mộc, gỗ tái chế, đồ gỗ Việt Nam, sản phẩm xanh">
  <!-- SEO Meta Tags -->
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta property="og:title" content="Sản Phẩm Gỗ Tái Sinh | Đồ Gỗ Thủ Công Handmade - Mộc Tái Sinh">
  <meta property="og:description" content="Khám phá bộ sưu tập sản phẩm gỗ tái sinh độc đáo. Đồ gỗ thủ công handmade từ gỗ cũ, tre tái chế. Sản phẩm gỗ mộc chất lượng, thân thiện môi trường.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://moctaisinh.vn">
  <meta property="og:site_name" content="Mộc Tái Sinh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Sản Phẩm Gỗ Tái Sinh | Đồ Gỗ Thủ Công Handmade - Mộc Tái Sinh">
  <meta name="twitter:description" content="Khám phá bộ sưu tập sản phẩm gỗ tái sinh độc đáo. Đồ gỗ thủ công handmade từ gỗ cũ, tre tái chế. Sản phẩm gỗ mộc chất lượng, thân thiện môi trường.">
  <link rel="canonical" href="https://moctaisinh.vn/shop.html">


		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="css/tiny-slider.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		<title>Sản Phẩm Gỗ Tái Sinh | Đồ Gỗ Thủ Công Handmade - Mộc Tái Sinh</title>
	</head>

	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar navbar-expand-lg navbar-dark bg-dark" arial-label="Furni navigation bar" style="background: transparent !important; position: absolute; width: 100%; z-index: 10;">

			<div class="container">
				<a class="navbar-brand" href="index.html">moctaisinh<span>.</span>vn</a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Trang chủ</a>
						</li>
						<li class="active"><a class="nav-link" href="shop.html">Sản phẩm</a></li>
						<li><a class="nav-link" href="about.html">Về chúng tôi</a></li>
						<li><a class="nav-link" href="services.html">Dịch vụ</a></li>
						<li><a class="nav-link" href="blog.html">Blog</a></li>
						<li><a class="nav-link" href="contact.html">Kết nối với chúng tôi</a></li>
					</ul>

					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li><a class="nav-link" href="cart.html"><img src="images/cart.svg"></a></li>
					</ul>
				</div>
			</div>
				
		</nav>
		<!-- End Header/Navigation -->

		<!-- Start Hero Section -->
			<div class="hero" style="background: url('../images/hero-bg.jpg') center center/cover no-repeat; position: relative; min-height: 320px; padding: 64px 0 32px 0; display: flex; align-items: center;">
				<div style="position: absolute; inset: 0; background: rgba(59,93,80,0.7); z-index: 1;"></div>
				<div class="container" style="position: relative; z-index: 2;">
					<div class="row justify-content-between">
						<div class="col-lg-12">
							<div class="intro-excerpt">
								<h1>Khám phá bộ sưu tập</h1>
								<p class="mb-4">Khám phá các sản phẩm độc bản, mỗi món đồ là một câu chuyện mộc tái sinh, một phần ký ức, một nguồn cảm hứng sống xanh.<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- End Hero Section -->

		<!-- Start Product Filter & Sort Section -->
		<div class="shop-filters d-flex flex-wrap justify-content-center align-items-end gap-4 py-3 px-2 rounded-4 shadow-sm bg-white bg-opacity-75" style="max-width: 900px; margin: 0 auto 32px auto;">
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="filter-material" class="form-label mb-2 fw-semibold" style="display:block;">Chất liệu</label>
				<select id="filter-material" class="form-select rounded-pill px-4">
					<option>Tất cả</option>
					<option>Gỗ tái chế</option>
					<option>Tre cũ</option>
					<option>Vật liệu tự nhiên</option>
				</select>
			</div>
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="filter-style" class="form-label mb-2 fw-semibold" style="display:block;">Cảm hứng</label>
				<select id="filter-style" class="form-select rounded-pill px-4">
					<option>Tất cả</option>
					<option>Mộc mạc</option>
					<option>Cảm xúc</option>
					<option>Độc bản</option>
				</select>
			</div>
			<div class="filter-group text-center" style="min-width:180px;">
				<label for="sort-product" class="form-label mb-2 fw-semibold" style="display:block;">Sắp xếp</label>
				<select id="sort-product" class="form-select rounded-pill px-4">
					<option>Mới nhất</option>
					<option>Giá tăng dần</option>
					<option>Giá giảm dần</option>
					<option>Nổi bật</option>
					<option>Tên A-Z</option>
				</select>
			</div>
		</div>
		<!-- End Product Filter & Sort Section -->

		<!-- Loading overlay cho shop -->
		<div id="shopLoading" style="display:none;position:fixed;z-index:20000;top:0;left:0;width:100vw;height:100vh;background:rgba(255,255,255,0.9);backdrop-filter:blur(3px);align-items:center;justify-content:center;">
		  <div style="display:flex;flex-direction:column;align-items:center;text-align:center;">
		    <div class="spinner-border text-info" style="width:3rem;height:3rem;" role="status"></div>
		    <div style="margin-top:16px;font-weight:600;color:#3b5d50;font-size:1.1rem;">Đang tải sản phẩm...</div>
		    <div style="margin-top:8px;color:#6c757d;font-size:0.9rem;">Vui lòng chờ trong giây lát</div>
		  </div>
		</div>

		<div class="untree_co-section product-section before-footer-section">
		    <div class="container">
		      	<div class="row">

		      		<!-- Sản phẩm sẽ được render động bằng JS -->

		      	</div>
		    </div>
		</div>

		<!-- Start Load More Section -->
		<div class="container mt-2 mb-4 text-center">
			<button class="btn btn-secondary px-5 py-3" style="font-size: 1.1rem; border-radius: 30px; box-shadow: 0 2px 16px rgba(59,93,80,0.08);">Xem thêm sản phẩm</button>
		</div>
		<!-- End Load More Section -->

		<!-- Start CTA Section -->
		<div class="container my-5">
			<div class="row justify-content-center">
				<div class="col-lg-8 text-center">
					<h3 class="mb-4">Bạn cần đặt làm riêng 1 sản phẩm mang dấu ấn cá nhân?</h3>
					<p>Liên hệ với chúng tôi để cùng kể câu chuyện của bạn.</p>
					<a href="contact.html" class="btn btn-secondary">Liên hệ ngay</a>
				</div>
			</div>
		</div>
		<!-- End CTA Section -->

		<!-- Nút nổi Call & Zalo -->
		<style>
.fab-contact {
  position: fixed;
  right: 24px;
  bottom: 24px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.fab-contact-btn {
  width: 60px;
  height: 60px;
  border-radius: 100%;
  background-color: #30C04F;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 16px rgba(59,93,80,0.18);
  font-size: 28px;
  border: none;
  outline: none;
  cursor: pointer;
  transition: background 0.2s;
  animation: shakeFab 0.5s cubic-bezier(.36,.07,.19,.97) infinite;
  animation-iteration-count: infinite;
  animation-play-state: paused;
}
.fab-contact-btn.zalo-btn {
		.fab-contact-btn:hover {
		  background-color: #2bac47;
		  transform: scale(1.1);
		}  background: #008fe5;
  padding: 0;
}
.fab-contact-btn.zalo-btn img {
		.fab-contact-btn:hover {
		  background-color: #2bac47;
		  transform: scale(1.1);
		}  width: 32px;
  height: 32px;
}
@keyframes shakeFab {
  0% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-6px); }
  20%, 40%, 60%, 80% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}
</style>
<div class="fab-contact">
  <a href="tel:0373566167" class="fab-contact-btn" id="callFab" title="Gọi điện" onclick="handleCallClick(event)"><svg xmlns="http://www.w3.org/2000/svg" width="32" viewBox="0 0 32 32" height="32" fill="none" class="svg-icon"><path stroke-width="2" stroke-linecap="round" stroke="#fff" fill-rule="evenodd" d="m24.8868 19.1288c-1.0274-.1308-2.036-.3815-3.0052-.7467-.7878-.29-1.6724-.1034-2.276.48-.797.8075-2.0493.9936-2.9664.3258-1.4484-1.055-2.7233-2.3295-3.7783-3.7776-.6681-.9168-.4819-2.1691.3255-2.9659.5728-.6019.7584-1.4748.4802-2.2577-.3987-.98875-.6792-2.02109-.8358-3.07557-.2043-1.03534-1.1138-1.7807-2.1694-1.77778h-3.18289c-.60654-.00074-1.18614.25037-1.60035.69334-.40152.44503-.59539 1.03943-.53345 1.63555.344 3.31056 1.47164 6.49166 3.28961 9.27986 1.64878 2.5904 3.84608 4.7872 6.43688 6.4356 2.7927 1.797 5.9636 2.9227 9.2644 3.289h.1778c.5409.0036 1.0626-.2 1.4581-.569.444-.406.6957-.9806.6935-1.5822v-3.1821c.0429-1.0763-.7171-2.0185-1.7782-2.2046z" clip-rule="evenodd"></path></svg></a>
  <a href="https://zalo.me/0373566167" class="fab-contact-btn zalo-btn" id="zaloFab" title="Zalo" target="_blank"><img src="images/Icon_of_Zalo.png" alt="Zalo"></a>
</div>
<script>
		function loopShakeFab(btnId) {
		  var btn = document.getElementById(btnId);
		  if (!btn) return;
		  
		  // Thêm CSS animation cho hiệu ứng xoay và lắc
		  btn.style.cssText += `
			animation: modernShake 3s ease-in-out infinite;
			transform-origin: center;
		  `;
		  
		  // Tạo keyframes cho hiệu ứng hiện đại
		  if (!document.getElementById('modernShakeKeyframes')) {
			const style = document.createElement('style');
			style.id = 'modernShakeKeyframes';
			style.textContent = `
			  @keyframes modernShake {
				0%, 100% { 
				  transform: rotate(0deg) scale(1); 
				  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
				}
				10% { 
				  transform: rotate(-5deg) scale(1.05); 
				  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
				}
				20% { 
				  transform: rotate(5deg) scale(1.1); 
				  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
				}
				30% { 
				  transform: rotate(-3deg) scale(1.05); 
				  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
				}
				40% { 
				  transform: rotate(3deg) scale(1.1); 
				  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
				}
				50% { 
				  transform: rotate(-2deg) scale(1.05); 
				  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
				}
				60% { 
				  transform: rotate(2deg) scale(1.1); 
				  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
				}
				70% { 
				  transform: rotate(-1deg) scale(1.02); 
				  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
				}
				80% { 
				  transform: rotate(1deg) scale(1.05); 
				  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
				}
				90% { 
				  transform: rotate(0deg) scale(1.02); 
				  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
				}
			  }
			`;
			document.head.appendChild(style);
		  }
		  
		  // Thêm hiệu ứng hover
		  btn.addEventListener('mouseenter', function() {
			this.style.animationPlayState = 'paused';
			this.style.transform = 'scale(1.2) rotate(5deg)';
			this.style.boxShadow = '0 10px 30px rgba(0,0,0,0.5)';
		  });
		  
		  btn.addEventListener('mouseleave', function() {
			this.style.animationPlayState = 'running';
			this.style.transform = '';
			this.style.boxShadow = '';
		  });
		}
loopShakeFab('callFab');
loopShakeFab('zaloFab');

      // Xử lý nút gọi điện thông minh
      function handleCallClick(event) {
        event.preventDefault();
        
        // Hiển thị popup gọi điện
        showCallPopup();
      }
      
      // Hiển thị popup gọi điện
      function showCallPopup() {
        // Tạo popup container
        const popup = document.createElement('div');
        popup.id = 'callPopup';
        popup.style.cssText = `
          position: fixed;
          inset: 0;
          z-index: 3000;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(0,0,0,0.5);
          backdrop-filter: blur(4px);
        `;
        
        // Tạo popup content
        const popupContent = document.createElement('div');
        popupContent.style.cssText = `
          background: white;
          border-radius: 16px;
          padding: 32px;
          text-align: center;
          max-width: 400px;
          width: 90%;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
          animation: popupSlideIn 0.3s ease-out;
        `;
        
        popupContent.innerHTML = `
          <div style="margin-bottom: 24px;">
            <div style="width: 80px; height: 80px; background: #28a745; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px;">
              <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" fill="white"/>
              </svg>
            </div>
            <h3 style="margin: 0 0 8px; color: #333; font-size: 24px; font-weight: 600;">Gọi điện tư vấn</h3>
            <p style="margin: 0; color: #666; font-size: 16px;">Bạn có muốn gọi điện đến hotline của chúng tôi không?</p>
          </div>
          
          <div style="font-size: 28px; font-weight: 700; color: #28a745; margin-bottom: 24px; letter-spacing: 2px;">
            0373 566 167
          </div>
          
          <div style="display: flex; gap: 12px; justify-content: center;">
            <button onclick="closeCallPopup()" style="
              padding: 12px 24px;
              border: 2px solid #ddd;
              background: white;
              color: #666;
              border-radius: 8px;
              font-size: 16px;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.2s;
            " onmouseover="this.style.borderColor='#999'; this.style.color='#333'" onmouseout="this.style.borderColor='#ddd'; this.style.color='#666'">
              Hủy
            </button>
            <button onclick="makeCall()" style="
              padding: 12px 32px;
              border: none;
              background: #28a745;
              color: white;
              border-radius: 8px;
              font-size: 16px;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.2s;
            " onmouseover="this.style.background='#218838'" onmouseout="this.style.background='#28a745'">
              Gọi ngay
            </button>
          </div>
        `;
        
        // Thêm CSS animation
        const style = document.createElement('style');
        style.textContent = `
          @keyframes popupSlideIn {
            from {
              opacity: 0;
              transform: scale(0.8) translateY(-20px);
            }
            to {
              opacity: 1;
              transform: scale(1) translateY(0);
            }
          }
          @keyframes popupSlideOut {
            from {
              opacity: 1;
              transform: scale(1) translateY(0);
            }
            to {
              opacity: 0;
              transform: scale(0.8) translateY(-20px);
            }
          }
        `;
        document.head.appendChild(style);
        
        popup.appendChild(popupContent);
        document.body.appendChild(popup);
        
        // Đóng popup khi click bên ngoài
        popup.addEventListener('click', function(e) {
          if (e.target === popup) {
            closeCallPopup();
          }
        });
        
        // Đóng popup khi nhấn ESC
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            closeCallPopup();
          }
        });
      }
      
      // Đóng popup gọi điện
      function closeCallPopup() {
        const popup = document.getElementById('callPopup');
        if (popup) {
          popup.style.animation = 'popupSlideOut 0.2s ease-in';
          setTimeout(() => {
            document.body.removeChild(popup);
          }, 200);
        }
      }
      
      // Thực hiện cuộc gọi
      function makeCall() {
        const phoneNumber = '0373566167';
        
        // Kiểm tra xem có phải mobile không
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        if (isMobile) {
          // Trên mobile: gọi điện trực tiếp
          window.location.href = 'tel:' + phoneNumber;
        } else {
          // Trên desktop: tạo link ẩn và click để mở ứng dụng gọi điện
          const link = document.createElement('a');
          link.href = 'tel:' + phoneNumber;
          link.style.display = 'none';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          // Hiển thị thông báo
          showCallNotification('Đang mở ứng dụng gọi điện...');
        }
        
        closeCallPopup();
      }
    </script>

		<!-- Footer will be loaded automatically from footer.html -->
		<div class="footer-section">
			<!-- Footer will be loaded automatically from footer.html -->
		</div>	


			<script src="js/bootstrap.bundle.min.js"></script>
	<script src="js/tiny-slider.js"></script>
	<script src="js/custom.js"></script>
		<script>
const API_BASE = 'http://localhost:8080';
let allProducts = [];
let currentIndex = 0;
const pageSize = 8;
const productSection = document.querySelector('.product-section .row');
const loadMoreBtn = document.querySelector('.container.mt-2.mb-4.text-center button');
function showShopLoading(show=true) {
  document.getElementById('shopLoading').style.display = show ? 'flex' : 'none';
}
function formatVND(number) {
  if (!number) return '';
  return Number(number).toLocaleString('vi-VN') + '₫';
}
function truncateText(text, maxChars=60) {
  if (text.length <= maxChars) return text;
  return text.slice(0, maxChars-3) + '...';
}
function renderProducts() {
  // Xoá sản phẩm cũ
  productSection.innerHTML = '';
  // Render sản phẩm hiện tại
  for (let i = 0; i < currentIndex; i++) {
    const p = allProducts[i];
    if (!p) continue;
    const col = document.createElement('div');
    col.className = 'col-12 col-md-4 col-lg-3 mb-5';
    col.innerHTML = `
      <div class="product-item" data-product-id="${p.id}">
        <img src="${p.image}" class="img-fluid product-thumbnail">
        <h3 class="product-title clamp-2">${p.name}</h3>
        <strong class="product-price" style="display: block; margin-top: 8px; margin-bottom: 8px;">${formatVND(p.price)}</strong>
        <div class="product-desc-hover">${truncateText(p.description, 60)}</div>
        <span class="icon-cross"><img src="images/cross.svg" class="img-fluid"></span>
      </div>
    `;
    
    // Thêm event listener cho sản phẩm
    const productItem = col.querySelector('.product-item');
    productItem.addEventListener('click', function() {
      handleProductClick(p);
    });
    
    productSection.appendChild(col);
  }
  // Ẩn nút nếu hết sản phẩm
  if (currentIndex >= allProducts.length) {
    loadMoreBtn.style.display = 'none';
  } else {
    loadMoreBtn.style.display = '';
  }
}
async function fetchProducts() {
  showShopLoading(true);
  try {
    const res = await fetch(`${API_BASE}/api/products`);
    allProducts = await res.json();
    
    // Lưu danh sách sản phẩm vào window để sử dụng cho buyNowWithCheckout
    window.loadedProducts = allProducts;
    
    currentIndex = Math.min(pageSize, allProducts.length);
    renderProducts();
  } catch (e) {
    productSection.innerHTML = '<div class="text-danger">Không thể tải sản phẩm. Vui lòng thử lại sau.</div>';
    loadMoreBtn.style.display = 'none';
  }
  showShopLoading(false);
}
loadMoreBtn.addEventListener('click', function() {
  showShopLoading(true);
  setTimeout(() => { // Giả lập loading, có thể bỏ nếu muốn
    currentIndex = Math.min(currentIndex + pageSize, allProducts.length);
    renderProducts();
    showShopLoading(false);
  }, 600);
});
// CSS clamp 2 dòng cho tiêu đề
const style = document.createElement('style');
style.innerHTML = `.clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 2.6em; }`;
document.head.appendChild(style);
// Thêm CSS bo tròn ảnh sản phẩm và cố định chiều cao
const style2 = document.createElement('style');
style2.innerHTML = `
.product-thumbnail { 
  border-radius: 18px !important; 
  width: 100% !important;
  height: 280px !important;
  object-fit: cover !important;
}
.product-item {
  height: 100% !important;
  display: flex !important;
  flex-direction: column !important;
}
.product-item .product-title {
  flex-grow: 1 !important;
  margin-bottom: 8px !important;
}
.product-item .product-price {
  margin-top: auto !important;
}
`;
document.head.appendChild(style2);
// Hàm xử lý click sản phẩm - fetch data trước khi chuyển trang
async function handleProductClick(product) {
  // Cập nhật loading message
  const loadingDiv = document.getElementById('shopLoading');
  const loadingText = loadingDiv.querySelector('div:nth-child(2)');
  loadingText.textContent = `Đang tải thông tin ${product.name}...`;
  
  // Hiển thị loading overlay
  showShopLoading(true);
  
  try {
    // Fetch thông tin chi tiết sản phẩm từ API
    const response = await fetch(`${API_BASE}/api/products`);
    const allProducts = await response.json();
    const productDetail = allProducts.find(p => p.id === product.id);
    
    if (!productDetail) {
      throw new Error('Không tìm thấy thông tin sản phẩm');
    }
    
    // Preload tất cả ảnh của sản phẩm
    const imageUrls = [];
    if (productDetail.image) imageUrls.push(productDetail.image);
    if (productDetail.images) {
      const additionalImages = productDetail.images.split(',').map(url => url.trim());
      imageUrls.push(...additionalImages);
    }
    
    // Preload tất cả ảnh
    const preloadPromises = imageUrls.map(url => {
      return new Promise((resolve) => {
        const img = new Image();
        img.onload = resolve;
        img.onerror = resolve; // Vẫn tiếp tục nếu ảnh lỗi
        img.src = url;
      });
    });
    
    // Đợi tất cả ảnh load xong (tối đa 3 giây)
    await Promise.race([
      Promise.all(preloadPromises),
      new Promise(resolve => setTimeout(resolve, 3000))
    ]);
    
    // Lưu thông tin sản phẩm vào sessionStorage để trang detail sử dụng
    sessionStorage.setItem('productDetail', JSON.stringify(productDetail));
    
    // Cập nhật loading message
    loadingText.textContent = 'Chuyển trang...';
    
    // Thêm hiệu ứng transition mượt
    document.body.style.opacity = '0.8';
    document.body.style.transition = 'opacity 0.3s ease';
    
    setTimeout(() => {
      // Chuyển trang với dữ liệu đã có sẵn
      window.location.href = `detail.html?id=${product.id}`;
    }, 300);
    
  } catch (error) {
    console.error('Error fetching product details:', error);
    // Vẫn chuyển trang nếu có lỗi, để trang detail tự load
    window.location.href = `detail.html?id=${product.id}`;
  }
}

// Thêm CSS cho loading state và cải thiện UX
const loadingStyle = document.createElement('style');
loadingStyle.innerHTML = `
  .product-item {
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: visible;
  }
  
  .product-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(59,93,80,0.15);
  }
  
  .product-item:active {
    transform: translateY(-2px);
  }
  
  .product-item.loading {
    pointer-events: none;
    opacity: 0.7;
  }
  
  .product-item.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 20px;
    height: 20px;
    margin: -10px 0 0 -10px;
    border: 2px solid #3b5d50;
    border-top: 2px solid transparent;
    border-radius: 100%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Cải thiện loading overlay */
  #shopLoading {
    animation: fadeIn 0.3s ease;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
    /* Đảm bảo ảnh và nội dung luôn hiển thị đầy đủ */
  .product-item img,
  .product-item .product-thumbnail {
    position: relative !important;
    z-index: 10 !important;
    pointer-events: none;
  }
  
  .product-item .product-title,
  .product-item .product-price,
  .product-item .product-desc-hover {
    position: relative !important;
    z-index: 10 !important;
  }
  
  /* Đảm bảo icon cross giống trang index */
  .product-item .icon-cross {
    position: absolute !important;
    width: 35px !important;
    height: 35px !important;
    display: inline-block !important;
    background: #2f2f2f !important;
    bottom: 15px !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    margin-bottom: -17.5px !important;
    border-radius: 50% !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transition: .3s all ease !important;
    z-index: 20 !important;
  }
  
  .product-item .icon-cross img {
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
  }
  
  /* Hiển thị icon khi hover */
  .product-item:hover .icon-cross {
    bottom: 0 !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
  
  /* Đảm bảo hover không che nội dung */
  .product-item:hover img,
  .product-item:hover .product-thumbnail,
  .product-item:hover .icon-cross {
    z-index: 20 !important;
  }
 
 `;
  document.head.appendChild(loadingStyle);

// Khởi động
fetchProducts();
</script>
			<script src="js/checkout-utils.js">
		// Buy now function for shop page
		function buyNowWithCheckout(productId) {
			// Validate productId
			if (!productId) {
				showToast('Lỗi: Không tìm thấy ID sản phẩm!', 'error');
				return;
			}
			
			// Tìm sản phẩm trong danh sách đã load
			const product = window.loadedProducts ? window.loadedProducts.find(p => p.id == productId) : null;
			
			if (!product) {
				showToast('Lỗi: Không tìm thấy thông tin sản phẩm!', 'error');
				return;
			}
			
			// Tạo đơn hàng riêng cho checkout
			const checkoutCart = [{
				id: product.id,
				name: product.name,
				price: product.price,
				quantity: 1,
				image: product.image || 'images/product-1.png'
			}];
			
			localStorage.setItem('checkoutCart', JSON.stringify(checkoutCart));
			
			// Thông báo chuyển hướng
			showToast('Đang chuyển hướng đến trang thanh toán...', 'success');
			setTimeout(() => {
				CheckoutUtils.redirectToCheckout('buynow', productId);
			}, 1200);
		}
		
		// Hàm lấy thông tin sản phẩm theo ID (cần implement theo cấu trúc dữ liệu thực tế)
		function getProductById(productId) {
			// Implement logic lấy thông tin sản phẩm từ localStorage hoặc data
			// Ví dụ: return JSON.parse(localStorage.getItem('products')).find(p => p.id == productId);
			return null; // Cần implement thực tế
		}</script>
		<script src="js/footer-loader.js"></script>
	</body>

</html>
